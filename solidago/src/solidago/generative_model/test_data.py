from solidago.voting_rights import VotingRights
from solidago.scoring_model import DirectScoringModel
from solidago.privacy_settings import PrivacySettings
from solidago.judgments import DataFrameJudgments
from solidago.pipeline import Pipeline

import pandas as pd
import numpy as np


np.random.seed(0)

def print_user_models(models):
    print("[\n    " + ",\n    ".join([
        "{\n        " + ",\n        ".join([
            f"{user}: DirectScoringModel(" + "{\n            " + ",\n            ".join([
                f"{entity}: {str(models[test][user](entity, entities[test].loc[entity]))}"
                for entity in models[test][user].scored_entities(entities[test])
            ]) + "\n        })"
            for user in models[test]
        ]) + "\n    }"
        for _ in models
    ]) + "\n]")


#######################################
##                                   ##
##   Basic Generation of Test Data   ##
##                                   ##
#######################################

n_tests = 5

users = [
    pd.DataFrame(columns=["is_pretrusted"]),
    pd.DataFrame(dict(
        is_pretrusted=[True, False, False, True, True],
        trust_score=[0.8, 0.21333333333333335, 0.028444444444444446, 0.8037925925925926, 0.8]
    )),
    pd.DataFrame(dict(
        is_pretrusted=[True, False, False, True, True],
        trust_score=[0.8, 0.2171945701357466, 0.0, 0.8289592760180996, 0.8]
    ), index=[0, 4, 2, 8, 6]),
    pd.DataFrame(dict(
        is_pretrusted=(np.arange(5) % 3 == 0),
        trust_score=[0.8, 0.0, 0.0, 0.8, 0.21333333333333335],
        svd0=[1, 2, 5, 2, 1],
        svd1=[7, 2, 0, 1, 9]
    )),
    pd.DataFrame(dict(
        is_pretrusted=np.random.random(20) < 0.20,
        trust_score=[0.04478270804619478, 3.7355199183719185e-05, 0.03637379712287813,
            0.00214102869722107, 0.009943012913209853, 0.0001413345069935354,
            0.03476165169428667, 0.0023141842257231823, 0.0003555730318881166,
            0.017198996028511854, 7.978870514876874e-05, 0.040830925916064895, 
            0.0, 0.002020051872783562, 0.8449119837046595, 0.8000921460641155, 
            0.8028373541319094, 0.0042177586804884246, 0.0015930263323911784, 
            0.000788923880714716
        ],
        svd0=np.random.normal(0, 1, 20),
        svd1=np.random.normal(0, 1, 20),
        svd2=np.random.normal(0, 1, 20),
        svd3=np.random.normal(0, 1, 20),
        svd4=np.random.normal(0, 1, 20)
    ), index=2 * np.arange(20) + 3)
]
for u in users:
    u.index.name = "user_id"

vouches = [
    pd.DataFrame(columns=["voucher", "vouchee", "vouch"]),
    pd.DataFrame(dict(
        voucher=[0, 4, 1, 2],
        vouchee=[1, 1, 2, 3],
        vouch=[1, 1, 1, 1]
    )),
    pd.DataFrame(dict(
        voucher=[0, 4, 8, 2],
        vouchee=[4, 8, 4, 4],
        vouch=[1, 1, 1, 1]
    )),
    pd.DataFrame(dict(
        voucher=[0, 1, 2, 3],
        vouchee=[4, 4, 4, 4],
        vouch=[1, 1, 1, 1]
    )),
    pd.DataFrame(dict(
        voucher=2 * np.random.randint(0, 20, 80) + 3,
        vouchee=2 * np.random.randint(0, 20, 80) + 3,
        vouch=np.random.random(80)
    ))
]
vouches[4]["vouchee"] += 2 * (vouches[4]["vouchee"] == vouches[4]["voucher"])
vouches[4]["vouchee"] = ((vouches[4]["vouchee"] - 3) % 40) + 3

entities = [
    pd.DataFrame(),
    pd.DataFrame(index=[0, 1]),
    pd.DataFrame(index=[1, 6, 2]),
    pd.DataFrame(dict(
        svd0=[-1, 2, -1, 0, 0],
        svd1=[0, 0, 6, 4, 2]
    )),
    pd.DataFrame(dict(
        svd0=np.random.normal(0, 1, 50),
        svd1=np.random.normal(0, 1, 50),
        svd2=np.random.normal(0, 1, 50),
        svd3=np.random.normal(0, 1, 50),
        svd4=np.random.normal(0, 1, 50)
    ), index=3*np.arange(50) + 5)
]
for e in entities:
    e.index.name = "entity_id"

privacy = [
    PrivacySettings(),
    PrivacySettings({
        0: { 0: True,  1: True, 2: False, 3: True, 4: False },
        1: { 0: False, 1: True, 2: False, 3: True, 4: True }
    }),
    PrivacySettings({ 
        1: { 0: True,  4: True, 2: False, 8: True },
        6: { 0: False, 2: False, 8: True, 6: True },
        2: { 0: True, 4: True, 2: True, 6: True }
    }),
    PrivacySettings({
        0: { 0: True,  1: True, 2: False, 3: True, 4: False },
        1: { 1: True, 2: False, 3: True, 4: False },
        2: { 0: False,  1: True, 3: True, 4: False },
        3: { 0: True,  1: True, 3: True, 4: False },
        4: { 0: True,  1: True, 2: True, 3: True }
    }),
    PrivacySettings()
]
for _ in range(20 * 10):
    user = 2 * np.random.randint(20) + 3
    entity = 3 * np.random.randint(50) + 5
    privacy[4][user, entity] = (np.random.random() < 0.1)

judgments = [
    DataFrameJudgments(),
    DataFrameJudgments(pd.DataFrame(dict(
        user_id=[0, 1, 2, 3, 4],
        entity_a=[0, 0, 1, 0, 1],
        entity_b=[1, 1, 0, 1, 0],
        comparison=[-5, 3, -4, -8, -10],
        comparison_max=[10, 10, 10, 10, 10]
    ))),
    DataFrameJudgments(pd.DataFrame(dict(
        user_id=[0, 0, 0, 2, 2, 4, 6, 8],
        entity_a=[1, 2, 1, 2, 6, 1, 6, 1],
        entity_b=[6, 6, 2, 1, 1, 2, 2, 6],
        comparison=[-5, 3, -4, -8, -10, 2, 4, -4],
        comparison_max=[10, 10, 10, 10, 10, 10, 10, 10]
    ))),
    DataFrameJudgments(pd.DataFrame(dict(
        user_id= [0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 2, 2, 2, 3, 3, 3, 3, 3, 3, 4, 4, 4],
        entity_a=[0, 2, 4, 0, 1, 4, 3, 4, 0, 2, 1, 0, 4, 0, 0, 0, 0, 2, 4, 0, 1, 2],
        entity_b=[2, 3, 3, 2, 2, 3, 2, 1, 4, 3, 0, 4, 1, 1, 2, 3, 4, 3, 3, 1, 2, 3],
        comparison=    [-5,3,-4,-3,-3, 2, 4,-4, 3, 2, 1, 3, 4, 1, 2, 1, 2, 0,-1, 2,-1,-2],
        comparison_max=[5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5]
    )))
]
judgments4 = list()
for user in users[4].index:
    user_entities = list(privacy[4].entities(user))
    for e_index, e in enumerate(user_entities):
        for f in user_entities[e_index + 1:]:
            if np.random.random() <= 0.2:
                continue
            comparison_max = np.random.random() * 10
            comparison = (2 * np.random.random() - 1) * comparison_max
            judgments4.append((user, e, f, comparison, comparison_max))
judgments.append(DataFrameJudgments(pd.DataFrame(dict(
    user_id=[j[0] for j in judgments4],
    entity_a=[j[1] for j in judgments4],
    entity_b=[j[2] for j in judgments4],
    comparison=[j[3] for j in judgments4],
    comparison_max=[j[4] for j in judgments4]    
))))


######################################
##                                  ##
##          Pipeline Data           ##
##                                  ##
######################################

voting_rights = [
    VotingRights(),
    VotingRights({
        0: {0: 0.5, 1: 0.5, 2: 1.0, 3: 0.5, 4: 1.0},
        1: {0: 1.0, 1: 0.5, 2: 1.0, 3: 0.5, 4: 0.5}
    }),
    VotingRights({
        1: {0: 0.5, 8: 0.5, 2: 1.0, 4: 0.5},
        2: {0: 0.5, 2: 0.5, 4: 0.5, 6: 0.5},
        6: {0: 1.0, 8: 0.5, 2: 1.0, 6: 0.5}
    }),
    VotingRights({
        0: {
            0: 0.44495224952697754,
            1: 0.44495224952697754,
            2: 0.8899044990539551,
            3: 0.44495224952697754,
            4: 0.8899044990539551
        },
        1: {
            1: 0.44577765464782715,
            2: 0.8915553092956543,
            3: 0.44577765464782715,
            4: 0.8915553092956543
        },
        2: {0: 1.0, 1: 0.5, 3: 0.5, 4: 1.0},
        3: {0: 0.5, 1: 0.5, 3: 0.5, 4: 1.0},
        4: {0: 0.5, 1: 0.5, 2: 0.5, 3: 0.5}
    }),
    VotingRights({
        128: {
            11: 0.9441285133361816,
            9: 0.9441285133361816,
            35: 0.9441285133361816,
            33: 0.9441285133361816
        },
        131: {
            27: 0.5129427909851074,
            9: 0.5129427909851074,
            3: 0.5129427909851074,
            13: 0.5129427909851074
        },
        5: {25: 0.6980299949645996, 11: 0.6980299949645996, 15: 0.6980299949645996},
        134: {
            3: 0.711280345916748,
            27: 0.711280345916748,
            31: 0.8449119837046595,
            23: 0.711280345916748
        },
        8: {35: 0.5},
        137: {
            33: 0.8000921460641155,
            3: 0.3970675468444824,
            37: 0.3970675468444824,
            5: 0.3970675468444824,
            15: 0.3970675468444824,
            21: 0.1985337734222412,
            29: 0.3970675468444824
        },
        11: {13: 0.6807961463928223, 29: 0.6807961463928223, 7: 0.6807961463928223},
        140: {27: 1.0, 31: 1.0},
        14: {27: 0.5, 37: 1.0},
        143: {41: 1.0, 39: 1.0},
        17: {17: 0.40119051933288574, 37: 0.8023810386657715, 5: 0.8023810386657715},
        146: {
            7: 0.6073603630065918,
            41: 0.6073603630065918,
            19: 0.6073603630065918,
            27: 0.3036801815032959,
            31: 0.8449119837046595
        },
        20: {33: 1.0, 23: 1.0},
        149: {
            33: 0.8000921460641155,
            5: 0.6936907768249512,
            13: 0.6936907768249512,
            41: 0.6936907768249512
        },
        23: {17: 1.0, 39: 1.0},
        152: {
            33: 0.8000921460641155,
            3: 0.5529541969299316,
            35: 0.8028373541319094,
            5: 0.5529541969299316,
            27: 0.5529541969299316,
            29: 0.5529541969299316
        },
        26: {
            9: 0.5106015205383301,
            27: 0.5106015205383301,
            5: 0.5106015205383301,
            7: 0.5106015205383301
        },
        29: {35: 1.0},
        32: {
            17: 0.5018458366394043,
            5: 0.5018458366394043,
            13: 0.5018458366394043,
            37: 0.5018458366394043
        },
        35: {
            33: 0.8000921460641155,
            35: 0.8028373541319094,
            37: 0.7253193855285645,
            11: 0.7253193855285645,
            23: 0.7253193855285645
        },
        38: {
            25: 0.844367504119873,
            31: 0.42245599185232974,
            37: 0.844367504119873,
            15: 0.4221837520599365
        },
        41: {35: 1.0},
        44: {
            7: 0.424710750579834,
            15: 0.424710750579834,
            19: 0.424710750579834,
            25: 0.424710750579834,
            27: 0.424710750579834
        },
        47: {3: 1.0},
        50: {
            41: 0.6943659782409668,
            27: 0.6943659782409668,
            29: 0.6943659782409668,
            33: 0.8000921460641155
        },
        53: {
            5: 0.31296777725219727,
            39: 0.31296777725219727,
            9: 0.31296777725219727,
            11: 0.31296777725219727,
            19: 0.15648388862609863,
            21: 0.31296777725219727,
            23: 0.31296777725219727
        },
        56: {
            3: 0.7234749794006348,
            41: 0.7234749794006348,
            35: 0.8028373541319094,
            7: 0.7234749794006348
        },
        59: {
            5: 0.3042721748352051,
            39: 0.3042721748352051,
            9: 0.3042721748352051,
            15: 0.3042721748352051,
            17: 0.3042721748352051,
            19: 0.3042721748352051,
            23: 0.3042721748352051,
            31: 0.8449119837046595
        },
        62: {19: 1.0, 13: 1.0},
        65: {
            11: 0.7276425361633301,
            3: 0.7276425361633301,
            15: 0.7276425361633301,
            31: 0.8449119837046595
        },
        68: {
            3: 0.48137903213500977,
            5: 0.48137903213500977,
            9: 0.48137903213500977,
            11: 0.48137903213500977,
            15: 0.24068951606750488,
            31: 0.8449119837046595
        },
        71: {
            37: 0.504371166229248,
            11: 0.504371166229248,
            13: 0.504371166229248,
            39: 0.504371166229248
        },
        74: {11: 0.5, 35: 1.0, 37: 1.0},
        77: {13: 1.0},
        80: {
            7: 0.3615734577178955,
            21: 0.723146915435791,
            25: 0.723146915435791,
            29: 0.3615734577178955,
            31: 0.8449119837046595
        },
        83: {9: 0.6726441383361816, 11: 0.6726441383361816, 37: 0.6726441383361816},
        86: {
            33: 0.8292813301086426,
            29: 0.8292813301086426,
            13: 0.8292813301086426,
            7: 0.4146406650543213
        },
        89: {
            3: 0.4257540702819824,
            7: 0.4257540702819824,
            41: 0.4257540702819824,
            15: 0.4257540702819824,
            19: 0.4257540702819824
        },
        92: {
            33: 0.8000921460641155,
            37: 0.18958449363708496,
            39: 0.3791689872741699,
            41: 0.3791689872741699,
            19: 0.3791689872741699,
            23: 0.3791689872741699,
            27: 0.3791689872741699
        },
        95: {
            27: 0.523521900177002,
            25: 0.523521900177002,
            11: 0.523521900177002,
            15: 0.523521900177002
        },
        98: {25: 0.6996045112609863, 3: 0.6996045112609863, 37: 0.6996045112609863},
        101: {13: 0.8012070655822754, 29: 0.4006035327911377, 39: 0.8012070655822754},
        104: {
            39: 0.4014401435852051,
            9: 0.4014401435852051,
            13: 0.4014401435852051,
            17: 0.4014401435852051,
            19: 0.4014401435852051
        },
        107: {
            25: 0.7269625663757324,
            3: 0.7269625663757324,
            29: 0.7269625663757324,
            31: 0.8449119837046595
        },
        110: {
            35: 0.8482851982116699,
            5: 0.8482851982116699,
            37: 0.8482851982116699,
            13: 0.42414259910583496,
            31: 0.8482851982116699
        },
        113: {41: 0.4043147563934326, 21: 0.8086295127868652, 29: 0.8086295127868652},
        116: {
            9: 0.5865187644958496,
            3: 0.5865187644958496,
            29: 0.2932593822479248,
            23: 0.5865187644958496
        },
        119: {17: 0.40061306953430176, 5: 0.8012261390686035, 39: 0.8012261390686035},
        122: {
            3: 0.5336165428161621,
            35: 0.8028373541319094,
            13: 0.5336165428161621,
            17: 0.5336165428161621,
            29: 0.5336165428161621
        },
         125: {41: 1.0, 5: 0.5}
    })
]

preference_learned_models = [
    {},
    {
        0: DirectScoringModel({
            0: (2.442744770144431, 0.23858220932063043, 0.23858220932063043),
            1: (0.8883464252282663, 0.1926645489534319, 0.1926645489534319)
        }),
        1: DirectScoringModel({
            0: (-0.08481482164511747, 0.30036282809203907, 0.30036282809203907),
            1: (0.8099924355890906, 0.3064583062931543, 0.3064583062931543)
        }),
        2: DirectScoringModel({
            0: (0.24972449529661145, 0.25527813229060436, 0.25527813229060436),
            1: (1.4650230037382725, 0.274361936770972, 0.274361936770972)
        }),
        3: DirectScoringModel({
            0: (7.827307704402762, 0.1385049814590886, 0.1385049814590886),
            1: (5.114193798379525, -0.13699097453847156, -0.13699097453847156)
        }),
        4: DirectScoringModel({
            0: (9.907422846880136, -0.5134183034332978, -0.5134183034332978),
            1: (13.513999755872797, 0.09433582905451057, 0.09433582905451057)
        })
    },
    {
        0: DirectScoringModel({
            1: (2.9032350442521557, 0.4820017913666286, 0.4820017913666286),
            2: (1.2210170825198308, 0.4822442280509046, 0.4822442280509046),
            6: (1.7135632808009313, 0.5771490902340595, 0.5771490902340595)
        }),
        4: DirectScoringModel({
            1: (-0.1867370636734694, 0.33064819463669637, 0.33064819463669637),
            2: (0.4018200953426675, 0.33185903581068144, 0.33185903581068144)
        }),
        2: DirectScoringModel({
            1: (9.161333949676928, -0.5811340346015427, -0.5811340346015427),
            2: (11.349040738988966, 0.17772554446991892, 0.17772554446991892),
            6: (12.934538419620313, 0.08853308160923876, 0.08853308160923876)
        }),
        8: DirectScoringModel({
            1: (1.4650230037382723, 0.274361936770972, 0.274361936770972),
            6: (0.24972449529661123, 0.25527813229060436, 0.25527813229060436)
        }),
        6: DirectScoringModel({
            2: (1.465019187513167, 0.2743628731001778, 0.2743628731001778),
            6: (0.2497296190027921, 0.2552795809099639, 0.2552795809099639)
        })
    },
    {
        0: DirectScoringModel({
            0: (11.881717453910563, 0.07839891626001871, 0.07839891626001871),
            2: (7.766791637341129, -0.5315643938243243, -0.5315643938243243),
            3: (8.927383676119112, 0.28639132551270846, 0.28639132551270846),
            4: (11.142129271563851, 0.17543802097143432, 0.17543802097143432)
        }),
        1: DirectScoringModel({
            0: (4.446843477934458, 0.46723905605967897, 0.46723905605967897),
            1: (4.123653424728686, 0.4318778636237576, 0.4318778636237576),
            2: (3.178603517564289, 0.33791620890860713, 0.33791620890860713),
            3: (5.9599390584941, 0.4669905327988768, 0.4669905327988768),
            4: (5.869296542205002, 0.7838010745090758, 0.7838010745090758)
        }),
        2: DirectScoringModel({
            0: (0.1277240310126572, 0.6162779736325399, 0.6162779736325399),
            1: (1.1393912523523464, 0.5884704172656131, 0.5884704172656131),
            4: (0.3238930340644287, 0.6401891085543472, 0.6401891085543472)
        }),
        3: DirectScoringModel({
            0: (0.04488359678823404, 1.1176551734794027, 1.1176551734794027),
            1: (0.6192090835737201, 0.3328518650239911, 0.3328518650239911),
            2: (1.018084739295188, 0.6290580910221877, 0.6290580910221877),
            3: (0.7965101328376712, 0.9622889539246398, 0.9622889539246398),
            4: (1.3484871287513258, 0.5790264160739279, 0.5790264160739279)
        }),
        4: DirectScoringModel({
            0: (0.5767384219252045, 0.2520071984739186, 0.2520071984739186),
            1: (1.8120580048149166, 0.5845962547430884, 0.5845962547430884),
            2: (1.2361508618913446, 0.5869664143125968, 0.5869664143125968),
            3: (0.03406523524376692, 0.25740750634579285, 0.25740750634579285)
        })
    },
    {
        3: DirectScoringModel({
            65: (1.8607734647646037, 3.4875609038703344, 3.4875609038703344),
            98: (0.7525211637775117, 2.763470445703008, 2.763470445703008),
            131: (1.4797650433453124, 3.5351159564125503, 3.5351159564125503),
            68: (1.1807996385729111, 3.1891615060101306, 3.1891615060101306),
            56: (1.573772319986971, 3.876719932397201, 3.876719932397201),
            134: (1.6214111490477454, 2.890577739444675, 2.890577739444675),
            137: (1.236054491630818, 3.1579626433879096, 3.1579626433879096),
            107: (1.808121097879754, 3.5320246097673422, 3.5320246097673422),
            47: (2.099779971864008, 2.5296409622986884, 2.5296409622986884),
            116: (1.3234733262436733, 2.88972783304755, 2.88972783304755),
            152: (2.4326368419576303, 2.49439355217635, 2.49439355217635),
            89: (1.374656569001807, 3.506997973429794, 3.506997973429794),
            122: (1.7149017360301444, 2.8763999340816464, 2.8763999340816464)
        }),
        5: DirectScoringModel({
            32: (1.4519812898154922, 2.576111937270968, 2.576111937270968),
            68: (1.9521208657286861, 3.228712673733049, 3.228712673733049),
            137: (0.8384677852774891, 3.1309330481094837, 3.1309330481094837),
            110: (1.7390565252081132, 3.3982830136683657, 3.3982830136683657),
            17: (1.1161921259954526, 3.2457252056065413, 3.2457252056065413),
            149: (1.6079433643862122, 2.843540601536079, 2.843540601536079),
            53: (1.221450523943506, 2.941530878198665, 2.941530878198665),
            119: (0.9882598376748589, 3.5360668203155536, 3.5360668203155536),
            152: (1.0088210417063244, 2.8900113530953098, 2.8900113530953098),
            26: (0.7102948207055223, 2.7273438450450964, 2.7273438450450964),
            59: (1.0136874533595446, 3.235387030955447, 3.235387030955447),
            125: (1.0416652532254376, 2.241910469009361, 2.241910469009361)
        }),
        7: DirectScoringModel({
            11: (2.055216338182365, 2.1897824038942653, 2.1897824038942653),
            44: (1.7759583766716849, 2.2111178723429923, 2.2111178723429923),
            80: (2.4394348995519084, 1.8705002185588793, 1.8705002185588793),
            146: (1.7343474890074762, 2.2082407868358214, 2.2082407868358214),
            86: (1.3570125983800108, 1.8233930784628445, 1.8233930784628445),
            56: (2.2248681292586823, 1.8556429251209638, 1.8556429251209638),
            89: (0.5518196566813659, 1.1134404214714226, 1.1134404214714226),
            26: (1.9823152043909467, 1.9707884905650193, 1.9707884905650193)
        }),
        9: DirectScoringModel({
            128: (7.486721079529304, 1.4257259727595666, 1.4257259727595666),
            131: (9.083642857065218, 1.5508700512004836, 1.5508700512004836),
            68: (8.219902024574205, 1.557933003779544, 1.557933003779544),
            104: (9.529740624617613, 1.7892200675381056, 1.7892200675381056),
            83: (10.905604726777057, 0.8129130267794844, 0.8129130267794844),
            116: (9.52681817078788, 1.8680572539542402, 1.8680572539542402),
            53: (8.418897005139698, 1.7137741345940174, 1.7137741345940174),
            26: (8.078748987956814, 1.7563898808581533, 1.7563898808581533),
            59: (8.61682965476511, 1.206963802895906, 1.206963802895906)
        }),
        11: DirectScoringModel({
            128: (13.053428460532995, 1.7661673987965416, 1.7661673987965416),
            65: (13.398893196252173, 1.4408160594753927, 1.4408160594753927),
            35: (11.614064620371346, 2.242911561202394, 2.242911561202394),
            68: (10.168962853031486, 0.6897038681892295, 0.6897038681892295),
            5: (10.937260420353475, 1.639680170525317, 1.639680170525317),
            71: (12.180919757523085, 1.870283675437551, 1.870283675437551),
            74: (12.084423973081446, 2.4178959602855126, 2.4178959602855126),
            83: (13.205622403542485, 2.1134382782230476, 2.1134382782230476),
            53: (12.4139295956874, 1.886400578229324, 1.886400578229324),
            95: (10.720166415179124, 0.9007857993906176, 0.9007857993906176)
        }),
        13: DirectScoringModel({
            32: (8.304594959134903, 2.432815301127259, 2.432815301127259),
            131: (8.65603639425448, 2.7639046296157623, 2.7639046296157623),
            101: (7.700520854729513, 2.8757139317114686, 2.8757139317114686),
            71: (7.752404320038997, 2.6738750252714345, 2.6738750252714345),
            104: (8.620452609676386, 3.0957876904118313, 3.0957876904118313),
            11: (6.124153575268017, 0.5419040651235023, 0.5419040651235023),
            77: (6.7592056523403405, 1.8003916073364175, 1.8003916073364175),
            110: (7.200657836272066, 1.798261424657693, 1.798261424657693),
            149: (8.404636569258527, 2.413200505260267, 2.413200505260267),
            86: (8.24976974159069, 2.3117595199964933, 2.3117595199964933),
            122: (8.051185310826304, 2.4877846910251797, 2.4877846910251797),
            62: (9.008437031374564, 2.2124018674255943, 2.2124018674255943)
        }),
        15: DirectScoringModel({
            65: (2.8129435780524026, 1.2436507483000103, 1.2436507483000103),
            68: (1.9107232229295517, 2.444698264103893, 2.444698264103893),
            5: (1.933674875267612, 1.5701902541668384, 1.5701902541668384),
            38: (2.273509121651541, 1.8804403806209073, 1.8804403806209073),
            137: (1.182634794649988, 1.4863981420543118, 1.4863981420543118),
            44: (2.988088487581276, 1.6390215763480853, 1.6390215763480853),
            89: (2.514242260726341, 1.8515274746435606, 1.8515274746435606),
            59: (1.0491891964968414, 1.1793159967251534, 1.1793159967251534),
            95: (2.0241881450903842, 2.1355808069127247, 2.1355808069127247)
        }),
        17: DirectScoringModel({
            32: (5.315435356671072, 1.3118020888112056, 1.3118020888112056),
            104: (3.18058642670811, 0.6778782333029634, 0.6778782333029634),
            17: (5.172745372649794, 1.1626835978586216, 1.1626835978586216),
            23: (4.606594729965866, 1.4796011097639954, 1.4796011097639954),
            119: (4.323024598336874, 1.1948670347600314, 1.1948670347600314),
            122: (5.034630291789387, 1.0792003455391832, 1.0792003455391832),
            59: (3.511329017049225, 1.3336396705680058, 1.3336396705680058)
        }),
        19: DirectScoringModel({
            104: (3.3591292108485584, 1.521565415751012, 1.521565415751012),
            44: (3.143971174789337, 2.076643785042091, 2.076643785042091),
            146: (2.46471625872028, 1.6133000447898562, 1.6133000447898562),
            53: (3.248151792542069, 2.103597703083155, 2.103597703083155),
            89: (4.653733294980182, 1.4922614597658743, 1.4922614597658743),
            59: (2.7622839100796774, 1.5741296407406413, 1.5741296407406413),
            92: (3.5583761176884594, 2.1226459157120345, 2.1226459157120345),
            62: (4.181355526966368, 1.6363740198998322, 1.6363740198998322)
        }),
        21: DirectScoringModel({
            80: (1.2655319027624699, 0.9125371486265805, 0.9125371486265805),
            113: (0.6118136632808244, 0.9634060912046425, 0.9634060912046425),
            137: (1.0033570635334652, 0.9555090740380459, 0.9555090740380459),
            53: (0.07614567284199643, 0.8496547790697583, 0.8496547790697583)
        }),
        23: DirectScoringModel({
            35: (4.656135321951199, 1.1386421908663282, 1.1386421908663282),
            134: (4.360734090921388, 1.4784807371429067, 1.4784807371429067),
            116: (4.36417990022784, 1.1610985351774321, 1.1610985351774321),
            53: (6.397211325952254, 1.3577125802891623, 1.3577125802891623),
            20: (5.183894626024428, 1.4433808653058933, 1.4433808653058933),
            59: (4.814178971584079, 1.3864249425695343, 1.3864249425695343),
            92: (6.096012908803688, 1.278582870192044, 1.278582870192044)
        }),
        25: DirectScoringModel({
            98: (3.0942210030042174, 1.5634511476262918, 1.5634511476262918),
            5: (3.800644679647035, 1.631584320304184, 1.631584320304184),
            38: (2.083081721843557, 1.5046809255774973, 1.5046809255774973),
            107: (3.687394532483843, 1.6847752349434402, 1.6847752349434402),
            44: (2.2053247592856886, 1.3145894257764452, 1.3145894257764452),
            80: (2.7934620734723117, 1.8397157002125328, 1.8397157002125328),
            95: (2.901665991680571, 1.8517943359277655, 1.8517943359277655)
        }),
        27: DirectScoringModel({
            131: (9.064722753678312, 2.274555917133567, 2.274555917133567),
            134: (9.12563814073402, 1.9353235949101228, 1.9353235949101228),
            140: (7.863538801667389, 1.3601516100657043, 1.3601516100657043),
            44: (8.756157560745597, 2.5320107545996744, 2.5320107545996744),
            14: (8.267758218144799, 2.402407185684004, 2.402407185684004),
            146: (11.064560173138448, 1.1744192311484114, 1.1744192311484114),
            50: (8.30597246692629, 1.9641611051092995, 1.9641611051092995),
            152: (8.316874115708396, 2.3485034740642248, 2.3485034740642248),
            26: (9.744557782511604, 1.9570251622496402, 1.9570251622496402),
            92: (9.174673962067969, 2.2215471395953625, 2.2215471395953625),
            95: (8.747103476776156, 2.4887118683471603, 2.4887118683471603)
        }),
        29: DirectScoringModel({
            101: (3.7678760661038004, 2.45983175488737, 2.45983175488737),
            137: (2.5672974804201347, 2.019619902064755, 2.019619902064755),
            11: (2.3971483785657495, 2.114595834486521, 2.114595834486521),
            107: (2.9909913069225205, 3.115694638568673, 3.115694638568673),
            80: (3.726140538409385, 2.6424714773372675, 2.6424714773372675),
            113: (3.002296804231011, 2.5257265078982045, 2.5257265078982045),
            50: (1.949817585570217, 1.6046890283699669, 1.6046890283699669),
            116: (3.7330601403141968, 2.6020662708590105, 2.6020662708590105),
            86: (2.886865610479472, 2.1580477328833805, 2.1580477328833805),
            152: (3.427218601180628, 1.8713680705772588, 1.8713680705772588),
            122: (3.4850771088007915, 2.7250795454865173, 2.7250795454865173)
        }),
        31: DirectScoringModel({
            65: (3.673605259469846, 2.4716075641445503, 2.4716075641445503),
            68: (4.234730665990858, 2.4045871723728314, 2.4045871723728314),
            134: (4.3060665849169455, 2.377798327283296, 2.377798327283296),
            38: (2.8160115263092256, 2.1922589280329063, 2.1922589280329063),
            107: (3.353747461614963, 2.1204242932581954, 2.1204242932581954),
            140: (3.366919100786588, 2.3521807764001803, 2.3521807764001803),
            110: (3.1006866103999493, 2.1839323322091144, 2.1839323322091144),
            80: (4.774708040194092, 2.090865700076417, 2.090865700076417),
            146: (3.5983090699825326, 2.1990181775355753, 2.1990181775355753),
            59: (4.342957159515738, 2.6394178180054695, 2.6394178180054695)
        }),
        33: DirectScoringModel({
            128: (2.782007341496086, 2.4981653199147007, 2.4981653199147007),
            35: (1.6630400412546433, 2.033274334491611, 2.033274334491611),
            137: (2.1440453375661903, 2.211539701772282, 2.211539701772282),
            50: (2.67623923530317, 2.1839515726935783, 2.1839515726935783),
            20: (2.5563065647368064, 2.516312668956486, 2.516312668956486),
            149: (2.7557655568000583, 2.213770585292649, 2.213770585292649),
            86: (3.574307572847932, 1.5561107369285871, 1.5561107369285871),
            152: (1.8941537688936432, 1.9641182977058569, 1.9641182977058569),
            92: (2.9274172175638573, 1.8255871925581144, 1.8255871925581144)
        }),
        35: DirectScoringModel({
            128: (1.5901567901211016, 2.3278072142287076, 2.3278072142287076),
            35: (1.1574499558680125, 1.4920753489369933, 1.4920753489369933),
            56: (2.4316105456468096, 2.7852986802029793, 2.7852986802029793),
            8: (2.074763931670236, 2.8254487407082243, 2.8254487407082243),
            41: (2.2052642660669197, 1.914943967910966, 1.914943967910966),
            74: (1.5186648423441513, 2.177686833318874, 2.177686833318874),
            110: (3.1142349507963596, 1.6028389663066593, 1.6028389663066593),
            152: (2.0457881159160647, 1.9467958978871833, 1.9467958978871833),
            122: (2.694692908973918, 2.193757912231258, 2.193757912231258),
            29: (2.3034530802874547, 2.5264001465441375, 2.5264001465441375)
        }),
        37: DirectScoringModel({
            32: (5.269666226929248, 1.7760544036613104, 1.7760544036613104),
            98: (3.8233279692721935, 2.0950131989684957, 2.0950131989684957),
            35: (4.338347903640424, 2.777966783947874, 2.777966783947874),
            38: (4.168111795560969, 2.304730240947745, 2.304730240947745),
            71: (4.7704183532190685, 2.4327107631972695, 2.4327107631972695),
            137: (4.289728330822387, 2.503155961525664, 2.503155961525664),
            74: (3.7811877982962434, 2.4591717739791426, 2.4591717739791426),
            14: (5.1015532243041495, 2.3592410900560923, 2.3592410900560923),
            110: (5.012134157099749, 2.8701476633777734, 2.8701476633777734),
            17: (3.904710681054573, 2.65197203359952, 2.65197203359952),
            83: (3.3724209360543784, 1.8581133263545746, 1.8581133263545746),
            92: (5.593535948966368, 1.628675012878388, 1.628675012878388)
        }),
        39: DirectScoringModel({
            101: (3.203735075740213, 2.1083677477430705, 2.1083677477430705),
            71: (2.196608481831644, 2.3346818767337076, 2.3346818767337076),
            104: (2.834989803348162, 2.1695203781094405, 2.1695203781094405),
            143: (3.238094522615317, 1.864381273483091, 1.864381273483091),
            23: (3.156751072287605, 2.0825723274840398, 2.0825723274840398),
            53: (2.336481181428675, 2.123414879032046, 2.123414879032046),
            119: (1.3555475578047098, 1.2363587375809877, 1.2363587375809877),
            59: (2.470108715142839, 2.1631881837482547, 2.1631881837482547),
            92: (3.258666848017151, 1.572704958178174, 1.572704958178174)
        }),
        41: DirectScoringModel({
            143: (3.864177266949227, 1.7443297196441359, 1.7443297196441359),
            113: (2.7098672098969043, 2.030350901596369, 2.030350901596369),
            146: (2.4395730724311395, 1.8868814849621938, 1.8868814849621938),
            50: (2.0701613624740696, 1.0500556371178813, 1.0500556371178813),
            149: (2.773293973120466, 2.3562503910198154, 2.3562503910198154),
            56: (3.1152167451198842, 2.094620310212999, 2.094620310212999),
            89: (1.8590251950194836, 1.4524447590913614, 1.4524447590913614),
            92: (3.927921089490959, 1.4244027942277337, 1.4244027942277337),
            125: (3.780274419508034, 1.9779522924335078, 1.9779522924335078)
        })
    }
]




pipeline = Pipeline()

#user_models = [
#    pipeline.scaling(user_models[test], users[test], entities[test], voting_rights[test], privacy[test])
#    for test in range(n_tests)
#]


